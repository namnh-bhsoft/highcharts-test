<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Task#14184</title>
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/maps/modules/map.js"></script>
    <script src="https://code.highcharts.com/maps/modules/data.js"></script>
    <script src="https://rawgithub.com/paulo-raca/highcharts-contour/master/highcharts-contour.js"></script>
    <script src="https://rawgithub.com/ironwallaby/delaunay/master/delaunay.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>

<body>
    <div id="container" style="width:100%; height:400px;"></div>
    <script>
        const data = {
            "charts": [{
                "column": 0,
                "row": 0,
                "title": "BIBER Iso Velocities",
                "subtitle": null,
                "additonalInfo": {
                    "data": {
                        "z": [
                            [0.0241, 0.102, 0.1229, 0.1625, 0.2073, 0.175, 0.2165, 0.2179, 0.2113, 0.2632, 0.2559, 0.2355, 0.1878, 0.1817, 0.1766, 0.1625, 0.18, 0.1168, 0.1077],
                            [0.0233, 0.0997, 0.1201, 0.1588, 0.2026, 0.171, 0.2115, 0.2129, 0.2065, 0.2572, 0.25, 0.2301, 0.1835, 0.1775, 0.1725, 0.1574, 0.171, 0.1099, 0.1001],
                            [0.0224, 0.0969, 0.1168, 0.156, 0.199, 0.1679, 0.2077, 0.2092, 0.2028, 0.2526, 0.2432, 0.226, 0.182, 0.1727, 0.1678, 0.1511, 0.1579, 0.1006, 0.0884],
                            [0.0211, 0.0948, 0.1142, 0.1511, 0.195, 0.1645, 0.2012, 0.2026, 0.1987, 0.2475, 0.2379, 0.2189, 0.1785, 0.1689, 0.1641, 0.1426, 0.1295, 0.0762, null],
                            [0.0191, 0.091, 0.1096, 0.1472, 0.1878, 0.1606, 0.1961, 0.1974, 0.194, 0.2384, 0.2283, 0.2133, 0.1746, 0.1621, 0.1575, 0.1333, null, null, null],
                            [0, 0.0859, 0.1058, 0.1399, 0.1819, 0.1561, 0.1899, 0.1912, 0.1854, 0.2309, 0.2203, 0.2027, 0.1701, 0.1564, 0.1487, 0.106, null, null, null],
                            [null, 0.0811, 0.0976, 0.1333, 0.1746, 0.1473, 0.1776, 0.1788, 0.1779, 0.2216, 0.2033, 0.1932, 0.1648, 0.1444, 0.1403, null, null, null, null],
                            [null, 0.0665, 0.0884, 0.117, 0.1581, 0.139, 0.1651, 0.1662, 0.1679, 0.2007, 0.1842, 0.1695, 0.1582, 0.1308, 0.1151, null, null, null, null],
                            [null, null, null, 0, 0.1352, 0.1259, 0.1411, 0, 0.1521, 0.1716, null, 0, 0.1493, null, null, null, null, null, null],
                            [null, null, null, null, null, 0, null, null, null, null, null, null, 0.1352, null, null, null, null, null, null]
                        ],
                        "y": [0, 0.074, 0.148, 0.222, 0.296, 0.37, 0.444, 0.518, 0.592, 0.666],
                        "x": [3, 4, 5.5, 7, 8.5, 10, 11.5, 13, 14.5, 16, 17.5, 19, 20.5, 22, 23.5, 25, 26.5, 28, 29]
                    }
                },
                "xaxis": [{
                    "label": "Distance",
                    "unit": "m",
                    "yaxis": [{
                        "label": "Height",
                        "unit": "m",
                        "plots": [{
                            "label": "Ground",
                            "data": [
                                [1.999, 0],
                                [2, 0.17],
                                [3, 0.37],
                                [4, 0.56],
                                [5.5, 0.58],
                                [7, 0.6],
                                [8.5, 0.64],
                                [10, 0.68],
                                [11.5, 0.63],
                                [13, 0.62],
                                [14.5, 0.66],
                                [16, 0.64],
                                [17.5, 0.58],
                                [19, 0.6],
                                [20.5, 0.74],
                                [22, 0.59],
                                [23.5, 0.56],
                                [25, 0.4],
                                [26.5, 0.26],
                                [28, 0.24],
                                [29, 0.2],
                                [30, 0.08],
                                [30.001, 0]
                            ]
                        }, {
                            "label": "Surface",
                            "data": []
                        }, {
                            "label": "Verticals",
                            "data": []
                        }]
                    }]
                }]
            }]
        }
        const config = {
            "columncount": 1,
            "rowcount": 1,
            "locale": "en",
            "charts": [{
                "column": 0,
                "row": 0,
                "type": "contour",
                "additonalInfo": {
                    "level": [{
                        "value": 0.0200,
                        "color": {
                            "r": 255,
                            "g": 0,
                            "b": 0,
                            "a": 1
                        }
                    }, {
                        "value": 0.0400,
                        "color": {
                            "r": 0,
                            "g": 255,
                            "b": 0,
                            "a": 1
                        }
                    }, {
                        "value": 0.0600,
                        "color": {
                            "r": 255,
                            "g": 127,
                            "b": 127,
                            "a": 1
                        }
                    }, {
                        "value": 0.0800,
                        "color": {
                            "r": 0,
                            "g": 0,
                            "b": 255,
                            "a": 1
                        }
                    }, {
                        "value": 0.1000,
                        "color": {
                            "r": 46,
                            "g": 139,
                            "b": 85,
                            "a": 1
                        }
                    }, {
                        "value": 0.1200,
                        "color": {
                            "r": 255,
                            "g": 255,
                            "b": 0,
                            "a": 1
                        }
                    }, {
                        "value": 0.1400,
                        "color": {
                            "r": 0,
                            "g": 0,
                            "b": 255,
                            "a": 1
                        }
                    }, {
                        "value": 0.1600,
                        "color": {
                            "r": 255,
                            "g": 0,
                            "b": 255,
                            "a": 1
                        }
                    }, {
                        "value": 0.1800,
                        "color": {
                            "r": 127,
                            "g": 127,
                            "b": 255,
                            "a": 1
                        }
                    }, {
                        "value": 0.2000,
                        "color": {
                            "r": 111,
                            "g": 31,
                            "b": 111,
                            "a": 1
                        }
                    }, {
                        "value": 0.2200,
                        "color": {
                            "r": 64,
                            "g": 64,
                            "b": 64,
                            "a": 1
                        }
                    }, {
                        "value": 0.2400,
                        "color": {
                            "r": 239,
                            "g": 159,
                            "b": 0,
                            "a": 1
                        }
                    }, {
                        "value": 0.2600,
                        "color": {
                            "r": 128,
                            "g": 128,
                            "b": 128,
                            "a": 1
                        }
                    }]
                },
                "legend": {
                    "visible": false,
                    "floating": true,
                    "layout": "vertical",
                    "hAlign": "center",
                    "vAlign": "middle",
                    "padding": 20,
                    "margin": 20,
                    "bordersize": 1,
                    "xpos": 0,
                    "ypos": 0
                },
                "xaxis": [{
                    "label": "Distance",
                    "position": "bottom",
                    "scale": "auto",
                    "min": 0,
                    "max": 0,
                    "reversed": false,
                    "yaxis": [{
                        "position": "left",
                        "scale": "auto",
                        "label": "Height",
                        "reversed": true,
                        "min": 0,
                        "max": 0,
                        "plots": [{
                            "label": "Ground",
                            "hidden": false,
                            "visible": false,
                            "flyover": false,
                            "lineColor": {
                                "r": 250,
                                "g": 0,
                                "b": 234,
                                "a": 0
                            },
                            "lineStyle": null,
                            "lineSize": 0,
                            "symbolColor": {
                                "r": 0,
                                "g": 0,
                                "b": 0,
                                "a": 0
                            },
                            "symbolFillColor": {
                                "r": 0,
                                "g": 0,
                                "b": 0,
                                "a": 0
                            },
                            "symbolStyle": null,
                            "symbolSize": 0
                        }, {
                            "label": "Surface",
                            "hidden": false,
                            "visible": false,
                            "flyover": false,
                            "lineColor": {
                                "r": 0,
                                "g": 0,
                                "b": 0,
                                "a": 0
                            },
                            "lineStyle": null,
                            "lineSize": 0,
                            "symbolColor": {
                                "r": 0,
                                "g": 0,
                                "b": 0,
                                "a": 0
                            },
                            "symbolFillColor": {
                                "r": 0,
                                "g": 0,
                                "b": 0,
                                "a": 0
                            },
                            "symbolStyle": null,
                            "symbolSize": 0
                        }, {
                            "label": "Verticals",
                            "hidden": false,
                            "visible": false,
                            "flyover": false,
                            "lineColor": {
                                "r": 0,
                                "g": 0,
                                "b": 0,
                                "a": 0
                            },
                            "lineStyle": null,
                            "lineSize": 0,
                            "symbolColor": {
                                "r": 0,
                                "g": 0,
                                "b": 0,
                                "a": 0
                            },
                            "symbolFillColor": {
                                "r": 0,
                                "g": 0,
                                "b": 0,
                                "a": 0
                            },
                            "symbolStyle": null,
                            "symbolSize": 0
                        }]
                    }]
                }]
            }]
        }
        
        // Contour Config
        const stops = [];
        const level = config['charts'][0]['additonalInfo']['level'];
        for (let i = 0; i < level.length; i++) {
            stops.push([level[i].value, `rgba(${level[i].color.r}, ${level[i].color.g}, ${level[i].color.b}, ${level[i].color.a})`]);
        }
        const x = data['charts'][0]['additonalInfo']['data'].x;
        const y = data['charts'][0]['additonalInfo']['data'].y;
        const z = data['charts'][0]['additonalInfo']['data'].z;
        const dataChartContour = [];
        for (let i = 0; i < y.length; i++) {
            for (let j = 0; j < x.length; j++) {
                let value = z[i][j];
                dataChartContour.push([x[j], y[i], value]);
            }
        }
        // Area config
        let xaxis = data['charts'][0].xaxis[0];
        // console.log(xaxis);
        

        $(function () {
            Highcharts.chart('container', {
                chart: {
                    marginTop: 40,
                    marginBottom: 80,
                    plotBorderWidth: 1
                },
                title: {
                    text: "Contour Chart"
                },

                xAxis: {
                },

                yAxis: [{}],
                colorAxis: {
                    min: 0,
                    minColor: '#FFFFFF',
                    maxColor: Highcharts.getOptions().colors[0],
                    stops: [
                        [0, '#ffffb3'],
                        [0.3, '#b1ea46'],
                        [0.6, '#d28f1b'],
                        [0.9, '#F34509']
                    ],
                },
                legend: {
                    align: 'right',
                    layout: 'vertical',
                    margin: 0,
                    verticalAlign: 'top',
                    y: 23,
                    symbolHeight: 280,
                },
                series: [{
                    type: 'contour',
                    borderWidth: 1,
                    yAxis: 0,
                    showContours: true,
                    data: dataChartContour,
                    showEdges: true,
                    turboThreshold: 0,
                    boostThreshold: 0,
                    tooltip: {
                        pointFormat: '{point.x} - {point.y} - <b>{point.value} </b>'
                    },
                    
                }]
            });
        })
    </script>
</body>
</html>